<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#020617">
    <title>Home | Padeluminatis Pro</title>
    <meta name="description" content="Panel principal de Padeluminatis">
    <link rel="icon" type="image/x-icon" href="./imagenes/Logojafs.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="./css/core-bundle.css">
    <link rel="stylesheet" href="./css/themes.css">
    <link rel="stylesheet" href="./css/home.css">
    <link rel="stylesheet" href="./css/premium-v7.css">
    <link rel="stylesheet" href="./css/final-premium.css">
</head>

<body>
    <div class="sport-bg"></div>

    <main class="page-content home-main" style="padding-top: 75px; padding-bottom: 95px;">
        <div class="container px-2">
            <section class="card card-premium animate-fade-in welcome-hero-card">
                <div class="card-glow"></div>
                <div class="welcome-hero-grid">
                    <div class="welcome-hero-main">
                        <div class="welcome-kicker-row">
                            <span id="greeting-text"
                                class="text-[10px] font-black uppercase tracking-[4px] text-primary/80">ACCESO
                                AUTORIZADO</span>
                            <i class="fas fa-redo-alt text-[9px] text-white/20 cursor-pointer hover:text-primary transition-colors"
                                onclick="window.clearAppCache()" title="Limpiar Caché"></i>
                        </div>
                        <div class="welcome-hero-strip">
                            <span class="welcome-strip-item strong">PANEL ACTIVO</span>
                            <span id="welcome-sync-time" class="welcome-strip-item">--:--</span>
                            <span id="welcome-status-pill" class="welcome-strip-item muted">TEMPORADA</span>
                        </div>

                        <h1 id="user-name" class="welcome-hero-name">JUGADOR</h1>

                        <div class="welcome-meta-row mb-6">
                            <span id="user-handle" class="welcome-meta-pill">@padelero</span>
                            <span id="user-role" class="welcome-meta-pill muted">RANKING PRO</span>
                        </div>

                        <div class="welcome-stats-grid">
                            <div class="welcome-stat-pill">
                                <span class="label">RANGO</span>
                                <div class="val-box">
                                    <span id="user-rank" class="value">#--</span>
                                    <span id="user-rank-total" class="sub">/--</span>
                                </div>
                            </div>
                            <div class="welcome-stat-pill">
                                <span class="label">NIVEL</span>
                                <span id="user-lvl-display" class="value text-primary">2.50</span>
                            </div>
                            <div class="welcome-stat-pill">
                                <span class="label">ELO</span>
                                <span id="user-elo-display" class="value silver">1000</span>
                            </div>
                        </div>

                        <div id="online-count-display" class="mt-4">
                            <!-- Dynamic online count -->
                        </div>
                    </div>

                    <div class="welcome-avatar-wrap">
                        <div class="avatar-xl shadow-glow-primary welcome-avatar-frame">
                            <img id="welcome-avatar" src="./imagenes/Logojafs.png" alt="Avatar"
                                style="width:100%;height:100%;object-fit:cover;">
                        </div>
                        <div class="welcome-sync-pill">
                            <span class="text-[8px] font-black text-primary">EN VIVO</span>
                        </div>
                    </div>
                </div>
            </section>

            <section id="next-match-container" class="mt-3"></section>

            <!-- OPEN MATCHES SCANNER (MOVED HIGHER) -->
            <section class="mt-3 card-premium-v7 p-4 animate-up border-glow-cyan open-matches-section"
                style="animation-delay: 0.1s;">
                <div class="flex-row between items-center mb-4">
                    <div class="flex-col">
                        <span class="text-[10px] font-black text-primary uppercase tracking-[3px]">Partidos
                            Abiertos</span>
                        <span class="text-[8px] text-muted uppercase font-bold">Únete a un partido disponible</span>
                    </div>
                    <div class="flex-row items-center gap-2">
                        <button id="open-matches-prev-btn" class="open-nav-btn" onclick="window.scrollOpenMatches(-1)"
                            aria-label="Ver partidos anteriores">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <button id="open-matches-next-btn" class="open-nav-btn" onclick="window.scrollOpenMatches(1)"
                            aria-label="Ver más partidos">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                        <span id="open-matches-hint" class="open-scroll-hint hidden">
                            <i class="fas fa-arrows-left-right"></i> DESLIZA
                        </span>
                        <button id="open-matches-more-btn" class="open-more-btn" style="display:none;"
                            onclick="window.showAllOpenMatches()">
                            VER MÁS
                        </button>
                    </div>
                </div>
                <div id="open-matches-panel" class="open-matches-strip custom-scroll no-scrollbar">
                    <div class="flex-row center py-4 opacity-40 w-full">
                        <i class="fas fa-satellite-dish mb-2 mr-2"></i>
                        <span class="text-[9px] font-black uppercase tracking-widest">Escaneando Partidos...</span>
                    </div>
                </div>
            </section>

            <!-- UPCOMING MATCHES (NEW SECTION) -->
            <section class="mt-3 card-premium-v7 p-4 animate-up" style="animation-delay: 0.2s;">
                <div class="flex-row between items-center mb-4">
                    <div class="flex-col">
                        <span class="text-[10px] font-black text-muted uppercase tracking-[3px]">Tus Próximos
                            Partidos</span>
                        <span class="text-[8px] text-muted uppercase font-bold">Planificación de juego · lista
                            completa</span>
                    </div>
                    <i class="fas fa-calendar-alt text-muted text-xs"></i>
                </div>
                <div id="upcoming-matches-panel" class="flex-col gap-2">
                    <!-- Dynamic content -->
                </div>
            </section>

            <!-- TOP STATS (PREMIUM V7) -->
            <section class="mt-3 grid gap-3" style="grid-template-columns: repeat(3, 1fr);">
                <div class="stat-card-v7 cyan clickable" id="home-stat-level">
                    <span class="text-[10px] font-black uppercase text-muted tracking-widest">Nivel</span>
                    <span id="stat-level" class="text-xl font-black italic">2.5</span>
                </div>
                <div class="stat-card-v7 gold clickable" id="home-stat-points">
                    <span class="text-[10px] font-black uppercase text-muted tracking-widest">Puntos</span>
                    <span id="stat-pts" class="text-xl font-black italic">1000</span>
                </div>
                <div class="stat-card-v7 lime clickable" id="home-stat-streak">
                    <span class="text-[10px] font-black uppercase text-muted tracking-widest">Racha</span>
                    <span id="stat-streak" class="text-xl font-black italic">0</span>
                </div>
            </section>

            <section class="mt-3 card-premium-v7 p-3 animate-up" style="animation-delay: 0.15s;">
                <div class="flex-row between items-center mb-2">
                    <span class="text-[10px] font-black text-muted uppercase tracking-[3px]">Logros</span>
                    <span class="text-[8px] font-bold text-primary uppercase tracking-[2px]">Progreso</span>
                </div>
                <div id="home-achievements" class="home-achievements-grid">
                    <div class="opacity-30 text-[9px] font-black uppercase py-2">Sincronizando logros...</div>
                </div>
            </section>

            <!-- TOP 3 PODIUM (NEW VERTICAL) -->
            <section class="mt-4 mb-4">
                <div class="flex-row between items-center mb-3">
                    <span class="text-[10px] font-black text-muted uppercase tracking-[3px]">Elite Matrix Top 3</span>
                    <i class="fas fa-medal text-gold animate-bounce"></i>
                </div>
                <div id="vertical-podium" class="podium-vertical-v7 animate-fade-in">
                    <!-- Dynamic Content -->
                </div>
            </section>

            <!-- ECOSYSTEM HEALTH & LEVEL BREAKDOWN -->
            <section class="card card-premium-v7 mt-3 animate-fade-in shadow-cyan/10">
                <div class="flex-row between items-center mb-4">
                    <div class="flex-col">
                        <span class="text-[10px] font-black text-muted uppercase tracking-widest">Salud del
                            Ecosistema</span>
                        <div class="flex-row items-center gap-2 mt-1">
                            <div class="pulse-dot-green"></div>
                            <span id="eco-health-index"
                                class="text-xs font-black text-sport-green">Sincronizando...</span>
                        </div>
                    </div>
                    <div class="flex-col items-end">
                        <span class="text-[10px] font-black text-muted uppercase tracking-widest">Nivel Actual</span>
                        <span id="home-level-current" class="text-xs font-black text-white italic">NIVEL 2.50</span>
                    </div>
                </div>

                <!-- Detailed Progress Bar -->
                <div class="progress-bar-v7 large mb-2">
                    <div id="home-level-bar" class="fill-bar gradient-cyan" style="width: 50%;"></div>
                </div>
                <div class="flex-row between text-[9px] font-black text-muted uppercase">
                    <span id="home-level-lower">2.5</span>
                    <div id="home-level-points" class="flex-row gap-2"></div>
                    <span id="home-level-upper">3.0</span>
                </div>
            </section>

            <!-- ADN PLAYER STATE & RIVAL INTELLIGENCE -->
            <section class="mt-3 grid gap-3" style="grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));">
                <div id="adn-panel" class="card-premium-v7 p-4 animate-up border-glow-cyan"
                    style="animation-delay: 0.1s;">
                    <div class="card-scanline"></div>
                    <span class="text-[10px] font-black text-muted uppercase tracking-[3px] block mb-3">ADN /
                        PlayerState</span>
                    <div id="adn-content" class="flex-col gap-2">
                        <div class="flex-row between text-xs"><span class="text-muted">Estilo:</span> <span
                                id="dna-style" class="font-bold text-cyan">---</span></div>
                        <div class="flex-row between text-xs"><span class="text-muted">Mood:</span> <span id="dna-mood"
                                class="font-bold text-magenta">---</span></div>
                    </div>
                </div>
                <div id="rival-intel-panel"
                    class="card-premium-v7 p-4 animate-up border-glow-magenta cursor-pointer hover:bg-magenta/10 transition-colors"
                    style="animation-delay: 0.2s;" onclick="window.showRivalSelector()">
                    <div class="card-grid-bg"></div>
                    <span class="text-[10px] font-black text-muted uppercase tracking-[3px] block mb-3">Rival
                        Intelligence</span>
                    <div id="rival-intel-content" class="flex-row between gap-2">
                        <div class="flex-col center flex-1 opacity-50" id="intel-nemesis">
                            <i class="fas fa-skull text-magenta mb-1"></i>
                            <span class="text-[8px] font-black uppercase">Némesis</span>
                        </div>
                        <div class="flex-col center flex-1 opacity-50" id="intel-victim">
                            <i class="fas fa-crown text-gold mb-1"></i>
                            <span class="text-[8px] font-black uppercase">Víctima</span>
                        </div>
                        <div class="flex-col center flex-1 opacity-50" id="intel-partner">
                            <i class="fas fa-handshake text-cyan mb-1"></i>
                            <span class="text-[8px] font-black uppercase">Socio</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- AI INSIGHTS & QUICK ACTIONS (PREMIUM V7) -->
            <section class="mt-3">
                <div id="ai-welcome-box" class="card-premium-v7 ai-welcome-card clickable animate-fade-in">
                    <div class="flex-row items-center gap-4">
                        <div class="ai-avatar-glow">
                            <i class="fas fa-robot text-primary"></i>
                        </div>
                        <div class="flex-col">
                            <span class="text-[9px] font-black text-primary uppercase tracking-[3px]">Vecina AP
                                Insight</span>
                            <p class="ai-quote text-[11px] font-bold text-white leading-tight mt-1">Conectando con la
                                Matrix de Padel...</p>
                            <p id="ai-insight-meta" class="text-[9px] text-white/50 mt-1">Sincronizando datos de
                                ranking y partidos...</p>
                        </div>
                    </div>
                    <div id="ai-quick-home" class="ai-home-quick-row mt-3">
                        <button class="ai-home-quick-btn"
                            onclick="event.stopPropagation(); window.runAIQuickCommand('Mi ranking actual y como subir posiciones')">Ranking</button>
                        <button class="ai-home-quick-btn"
                            onclick="event.stopPropagation(); window.runAIQuickCommand('Analiza mi proximo partido y dame tactica')">Táctica</button>
                        <button class="ai-home-quick-btn"
                            onclick="event.stopPropagation(); window.runAIQuickCommand('Que partidos abiertos me convienen hoy')">Abiertos</button>
                        <button class="ai-home-quick-btn"
                            onclick="event.stopPropagation(); window.runAIQuickCommand('Dame un informe rapido de hoy')">Informe</button>
                        <button class="ai-home-quick-btn"
                            onclick="event.stopPropagation(); window.location.href='diario.html?open=note'">Nota</button>
                    </div>
                </div>
            </section>

            <section class="mt-3 grid gap-3" style="grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));">
                <div id="last-match-box" class="card-premium-v7 p-4 animate-up" style="animation-delay: 0.3s;">
                    <span class="text-[10px] font-black text-muted uppercase tracking-[3px] block mb-3">Último
                        Combate</span>
                    <div id="last-match-content" class="flex-col gap-2 opacity-50">
                        <span class="text-[10px]">Sincronizando...</span>
                    </div>
                </div>
                <div id="tip-box" class="card-premium-v7 p-4 animate-up flex-col center"
                    style="animation-delay: 0.4s; min-height: 100px;">
                    <i class="fas fa-brain text-xl text-primary mb-2"></i>
                    <span class="text-[9px] font-black text-muted uppercase">Análisis Estratégico</span>
                </div>
            </section>


        </div>
    </main>

    <div id="modal-match" class="modal-overlay">
        <div class="modal-card glass-strong slide-up">
            <div class="modal-header">
                <div class="flex-col">
                    <h3 class="modal-title text-accent font-black italic uppercase tracking-widest" id="modal-titulo">
                        MISIÓN TÁCTICA</h3>
                    <span class="text-[10px] text-muted font-black uppercase tracking-widest opacity-60">Sincronización
                        de Campo</span>
                </div>
                <button class="close-btn"
                    onclick="document.getElementById('modal-match').classList.remove('active')">&times;</button>
            </div>
            <div class="modal-body scroll-y" id="match-detail-area" style="max-height: 80vh;"></div>
        </div>
    </div>

    <script type="module" src="./js/home-logic.js"></script>
    <script type="module">
        import { initGalaxyBackground } from './js/modules/galaxy-bg.js';
        import { initThemeSystem } from './js/modules/theme-manager.js';
        initThemeSystem();
        initGalaxyBackground();
    </script>
    <div id="modal-ai-hub" class="modal-overlay">
        <div class="modal-card glass-strong slide-up">
            <div class="modal-header">
                <div class="flex-col">
                    <h3 class="modal-title font-black text-cyan tracking-widest italic">NEXO INTELIGENTE</h3>
                    <span class="text-[10px] text-muted font-bold uppercase tracking-[4px]">Análisis en tiempo
                        real</span>
                </div>
                <button class="close-btn"
                    onclick="document.getElementById('modal-ai-hub').classList.remove('active')">&times;</button>
            </div>

            <div class="modal-body custom-scroll p-4 flex-col gap-6">

                <!-- Ecosystem Health Index -->
                <div class="ai-section animate-up">
                    <div class="flex-row between items-center mb-2">
                        <span class="text-[10px] font-black text-muted uppercase tracking-widest">Salud del
                            Ecosistema</span>
                        <div class="flex-row items-center gap-2" id="eco-health-badge">
                            <span class="w-1.5 h-1.5 rounded-full bg-sport-green animate-pulse"></span>
                            <span class="text-[10px] font-bold text-sport-green"
                                id="eco-health-val">Calculando...</span>
                        </div>
                    </div>
                    <div class="progress-bar-v7">
                        <div id="eco-health-bar" class="fill-bar" style="width: 0%;"></div>
                    </div>
                </div>

                <!-- Live Level Progress -->
                <div class="ai-section animate-up" style="animation-delay: 0.1s;">
                    <div class="flex-row between items-end mb-2">
                        <span class="text-[10px] font-black text-muted uppercase tracking-widest">Nivel de
                            Combate</span>
                        <span id="ai-level-decimal"
                            class="text-2xl font-black text-white italic tracking-tighter">--.--</span>
                    </div>
                    <div class="progress-bar-v7 large">
                        <div id="ai-level-bar" class="fill-bar gradient-cyan" style="width: 0%;"></div>
                    </div>
                    <div class="flex-row between mt-1">
                        <span class="text-[9px] text-muted font-bold" id="ai-level-min">--</span>
                        <span class="text-[9px] text-muted font-bold" id="ai-level-max">--</span>
                    </div>
                    <div class="mt-2 p-2 rounded-xl bg-white/5 border border-white/5 text-[10px] text-muted italic"
                        id="ai-level-insight">
                        <i class="fas fa-circle-notch fa-spin mr-1 text-cyan"></i> Sincronizando datos...
                    </div>
                </div>

                <!-- Quick Actions Grid -->
                <div class="grid grid-cols-2 gap-3 animate-up" style="animation-delay: 0.2s;">
                    <div class="ai-action-card cyan" onclick="window.aiAction('profile')">
                        <i class="fas fa-user-astronaut"></i>
                        <span>Perfil</span>
                    </div>
                    <div class="ai-action-card magenta" onclick="window.aiAction('matches')">
                        <i class="fas fa-trophy"></i>
                        <span>Partidos</span>
                    </div>
                    <div class="ai-action-card lime" onclick="window.aiAction('ranking')">
                        <i class="fas fa-chart-line"></i>
                        <span>Rankings</span>
                    </div>
                    <div class="ai-action-card gold" onclick="window.aiAction('rivals')">
                        <i class="fas fa-crosshairs"></i>
                        <span>Rivales</span>
                    </div>
                    <div class="ai-action-card purple" onclick="window.aiAction('diary')">
                        <i class="fas fa-book-journal-whills"></i>
                        <span>Diario</span>
                    </div>
                    <div class="ai-action-card orange" onclick="window.aiAction('admin')">
                        <i class="fas fa-shield-halved"></i>
                        <span>Admin</span>
                    </div>
                    <div class="ai-action-card cyan" onclick="window.aiAction('open')">
                        <i class="fas fa-table-list"></i>
                        <span>Abiertos</span>
                    </div>
                    <div class="ai-action-card magenta" onclick="window.aiAction('chat')">
                        <i class="fas fa-comments"></i>
                        <span>Asistente</span>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <style>
        .ai-section {
            margin-bottom: 0px;
        }

        .ai-action-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .ai-action-card:active {
            transform: scale(0.95);
        }

        .ai-action-card i {
            font-size: 24px;
            opacity: 0.8;
        }

        .ai-action-card span {
            font-size: 10px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.6;
        }

        .ai-action-card.cyan:hover {
            background: rgba(0, 212, 255, 0.1);
            border-color: rgba(0, 212, 255, 0.3);
        }

        .ai-action-card.cyan i {
            color: var(--primary);
        }

        .ai-action-card.magenta:hover {
            background: rgba(255, 0, 85, 0.1);
            border-color: rgba(255, 0, 85, 0.3);
        }

        .ai-action-card.magenta i {
            color: var(--secondary);
        }

        .ai-action-card.lime:hover {
            background: rgba(198, 255, 0, 0.1);
            border-color: rgba(198, 255, 0, 0.3);
        }

        .ai-action-card.lime i {
            color: var(--sport-green);
        }

        .ai-action-card.gold:hover {
            background: rgba(255, 215, 0, 0.1);
            border-color: rgba(255, 215, 0, 0.3);
        }

        .ai-action-card.gold i {
            color: var(--sport-gold);
        }

        .ai-action-card.purple:hover {
            background: rgba(168, 85, 247, 0.1);
            border-color: rgba(168, 85, 247, 0.3);
        }

        .ai-action-card.purple i {
            color: #a855f7;
        }

        .ai-action-card.orange:hover {
            background: rgba(249, 115, 22, 0.1);
            border-color: rgba(249, 115, 22, 0.3);
        }

        .ai-action-card.orange i {
            color: #f97316;
        }

        .progress-bar-v7 {
            height: 6px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 99px;
            overflow: hidden;
            position: relative;
        }

        .progress-bar-v7.large {
            height: 12px;
        }

        .fill-bar {
            height: 100%;
            border-radius: 99px;
            background: var(--sport-green);
            transition: width 1s ease-out;
        }

        .fill-bar.gradient-cyan {
            background: var(--gradient-neon);
        }
    </style>
</body>

</html>
