<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#020617">
    <title>Diario Táctico | Padeluminatis Pro</title>
    <meta name="description" content="Tu bitácora personal de pádel">
    <link rel="icon" type="image/x-icon" href="./imagenes/Logojafs.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Core Bundle: design-system + layout + components-premium + themes + dynamic-elements -->
    <link rel="stylesheet" href="./css/core-bundle.css">
    <link rel="stylesheet" href="./css/themes.css">
    <link rel="stylesheet" href="./css/diario.css">
    <!-- Premium V7 Styles (New Design - High Priority) -->
    <link rel="stylesheet" href="./css/premium-v7.css">
    <link rel="stylesheet" href="./css/galactic-overrides.css">
    <style>
        /* Wizard specific styles */
        .wizard-step {
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .wizard-step.active {
            display: block;
            opacity: 1;
        }

        .wizard-progress {
            display: flex;
            gap: 4px;
            margin-bottom: 20px;
        }

        .w-bar {
            flex: 1;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
        }

        .w-bar.active {
            background: var(--primary);
            box-shadow: 0 0 10px var(--primary);
        }

        .w-bar.passed {
            background: var(--sport-green);
        }

        .stat-grid-v10 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .stat-item-v10 {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            padding: 10px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .stat-label {
            font-size: 10px;
            font-weight: 700;
            color: var(--text-muted);
            text-transform: uppercase;
            display: block;
            margin-bottom: 5px;
        }

        .rival-tag-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }

        .r-tag {
            padding: 6px 12px;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.05);
            font-size: 10px;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.6);
            cursor: pointer;
            border: 1px solid transparent;
            transition: all 0.2s;
        }

        .r-tag.active {
            background: rgba(var(--primary-rgb), 0.2);
            border-color: var(--primary);
            color: white;
        }

        /* Modal Sheet Premium V7 */
        .modal-sheet-v7 {
            position: relative;
            background: rgba(10, 12, 20, 0.95);
            backdrop-filter: blur(40px) saturate(180%);
            -webkit-backdrop-filter: blur(40px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 32px;
            width: 95%;
            max-width: 480px;
            height: auto;
            max-height: 85vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 50px 100px -20px rgba(0, 0, 0, 0.8), 0 0 60px rgba(0, 0, 0, 0.4);
            overflow: hidden;
            transform: translateY(30px);
            transition: all 0.5s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .modal-overlay.active .modal-sheet-v7 {
            transform: translateY(0);
        }

        .sheet-header-v7 {
            padding: 30px 30px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.02) 0%, transparent 100%);
        }

        .sheet-body-v7 {
            padding: 24px 30px;
            overflow-y: auto;
            flex: 1;
        }

        .sheet-footer-v7 {
            padding: 24px 30px;
            background: rgba(0, 0, 0, 0.3);
            border-top: 1px solid rgba(255, 255, 255, 0.05);
        }
    </style>
</head>

<body>
    <!-- Galactic Background -->
    <div class="sport-bg"></div>

    <!-- Header & Nav injected by JS -->

    <main class="page-content diary-page-v9">

        <!-- Page Header: Command Pulse -->
        <section class="diary-header-v9 animate-fade-in">
            <div class="h-glow"></div>
            <div class="header-main-v9">
                <div class="title-wrap-v9">
                    <h1 class="font-display font-black text-4xl italic tracking-tighter uppercase">
                        Diario <span class="text-primary italic glow-text-blue">Luminatis</span>
                    </h1>
                    <span class="text-[10px] font-black tracking-[5px] uppercase opacity-60 text-sport-green">
                        <i class="fas fa-microchip mr-1"></i> Padeluminatis Circuit v9.0
                    </span>
                </div>

                <div class="pulse-stats-v9">
                    <div class="p-stat">
                        <span class="p-val" id="stat-entries">0</span>
                        <span class="p-lbl">BITS</span>
                    </div>
                    <div class="p-stat">
                        <span class="p-val" id="stat-streak">0</span>
                        <span class="p-lbl">FIRE</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Dynamic Control Bar -->
        <section class="diary-controls-v9 animate-up" style="animation-delay: 0.1s;">
            <button class="btn-create-v9" onclick="window.openWizard()">
                <div class="btn-inner">
                    <i class="fas fa-plus-circle"></i>
                    <span>NUEVO REPORTE</span>
                </div>
                <div class="btn-bg"></div>
            </button>
            <button class="btn-ai-v9" onclick="showAIAnalysis()">
                <i class="fas fa-brain-circuit"></i>
                <span>ANALIZAR MATRIX</span>
            </button>
        </section>

        <!-- Main Journal Flow -->
        <section class="journal-flow-v9 animate-up" style="animation-delay: 0.2s;">
            <div class="flow-header-v9">
                <span class="text-[10px] font-black tracking-widest uppercase py-4">Sincronizaciones Recientes</span>
                <div class="h-line"></div>
            </div>

            <div id="journal-list" class="journal-grid-v9">
                <div class="loading-matrix text-center py-20">
                    <div class="spinner-neon mb-4"></div>
                    <span class="text-xs font-black tracking-widest opacity-50">SINCRONIZANDO CANALES...</span>
                </div>
            </div>
        </section>

    </main>

    <!-- Entry Wizard Modal -->
    <div id="modal-entry" class="modal-overlay">
        <div class="modal-sheet-v7">

            <div class="sheet-header-v7">
                <div class="flex-col w-full">
                    <div class="flex-row between items-center mb-4">
                        <span class="text-[9px] font-black text-primary tracking-widest uppercase">Protocolo de
                            Entrada</span>
                        <button class="btn-icon-glass" onclick="window.closeWizard()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="wizard-progress">
                        <div class="w-bar active" id="wb-1"></div>
                        <div class="w-bar" id="wb-2"></div>
                        <div class="w-bar" id="wb-3"></div>
                        <div class="w-bar" id="wb-4"></div>
                        <div class="w-bar" id="wb-5"></div>
                    </div>
                    <h3 class="text-xl font-black italic uppercase tracking-tighter" id="wizard-title">Contexto Global
                    </h3>
                </div>
            </div>

            <div class="sheet-body-v7 custom-scroll" style="padding-bottom: 80px;">

                <!-- STEP 1: CONTEXTO -->
                <div id="step-1" class="wizard-step active">
                    <div class="cfg-group-v9 mb-6">
                        <label class="cfg-label-v7">PARTIDO VINCULADO (REQUERIDO)</label>
                        <select id="inp-match-selector" class="select-v9"
                            onchange="window.onMatchSelectChange(this.value)">
                            <option value="">-- Selecciona un partido --</option>
                        </select>
                    </div>

                    <div class="cfg-grid-v9 mb-6">
                        <div class="cfg-group-v9">
                            <label class="cfg-label-v7">TIPO DE SESIÓN</label>
                            <select id="inp-tipo" class="select-v9">
                                <option value="Partido">Partido ELO</option>
                                <option value="Amistoso">Amistoso</option>
                                <option value="Entrenamiento">Entrenamiento</option>
                                <option value="Torneo">Torneo Oficial</option>
                            </select>
                        </div>
                        <div class="cfg-group-v9">
                            <label class="cfg-label-v7">HORA DEL DÍA</label>
                            <select id="inp-hora" class="select-v9">
                                <option value="mañana">Mañana (08-12)</option>
                                <option value="mediodia">Mediodía (12-16)</option>
                                <option value="tarde">Tarde (16-20)</option>
                                <option value="noche">Noche (20-00)</option>
                            </select>
                        </div>
                    </div>

                    <div class="cfg-group-v9 mb-6">
                        <label class="cfg-label-v7">VINCULAR PARTIDO OFICIAL</label>
                        <select id="inp-match-selector" class="select-v9"
                            onchange="window.onMatchSelectChange(this.value)">
                            <option value="">-- SELECCIONAR PARTIDO --</option>
                        </select>
                        <p class="text-[9px] text-muted italic mt-2">Solo aparecen tus partidos completados en la
                            Matrix.</p>
                    </div>

                    <div id="linked-match-info" class="link-hook-v9 hidden mb-6">
                        <div class="hook-glow"></div>
                        <div class="flex-row between items-center">
                            <div class="flex-row items-center gap-3">
                                <div class="hook-icon"><i class="fas fa-link"></i></div>
                                <div class="flex-col">
                                    <span
                                        class="text-[9px] font-black opacity-50 uppercase tracking-widest">Sincronización
                                        de Nodo</span>
                                    <span id="txt-match-date" class="text-xs font-bold">--/--/--</span>
                                    <span id="txt-result" class="text-[10px] text-sport-gold font-mono"></span>
                                </div>
                            </div>
                            <button class="text-[10px] font-black text-red-400 uppercase"
                                onclick="window.unlinkMatch()">DESVINCULAR</button>
                        </div>
                        <input type="hidden" id="inp-match-id">
                    </div>
                </div>

                <!-- STEP 2: ALINEACIÓN Y RIVAL -->
                <div id="step-2" class="wizard-step">
                    <div class="cfg-group-v9 mb-6">
                        <label class="cfg-label-v7">TU POSICIÓN</label>
                        <div class="segmented-v9" id="pos-selector">
                            <button class="seg-node-v9 active" data-val="reves">REVÉS</button>
                            <button class="seg-node-v9" data-val="drive">DRIVE</button>
                        </div>
                    </div>

                    <div class="cfg-group-v9 mb-6">
                        <label class="cfg-label-v7">TIPO DE RIVALES (ESTILO)</label>
                        <div class="rival-tag-grid" id="rival-tags">
                            <div class="r-tag" onclick="this.classList.toggle('active')">Agresivos</div>
                            <div class="r-tag" onclick="this.classList.toggle('active')">Defensivos</div>
                            <div class="r-tag" onclick="this.classList.toggle('active')">Globeros</div>
                            <div class="r-tag" onclick="this.classList.toggle('active')">Bandejeros</div>
                            <div class="r-tag" onclick="this.classList.toggle('active')">Tácticos</div>
                            <div class="r-tag" onclick="this.classList.toggle('active')">Irregulares</div>
                            <div class="r-tag" onclick="this.classList.toggle('active')">Nevera</div>
                        </div>
                    </div>

                    <div class="cfg-group-v9 mb-6">
                        <label class="cfg-label-v7">JUGADORES (OPCIONAL)</label>
                        <input type="text" id="inp-partner" class="input-v9 mb-2" placeholder="Tu compañero...">
                        <input type="text" id="inp-rival1" class="input-v9 mb-2" placeholder="Rival 1...">
                        <input type="text" id="inp-rival2" class="input-v9" placeholder="Rival 2...">
                    </div>
                </div>

                <!-- STEP 3: METRICAS -->
                <div id="step-3" class="wizard-step">
                    <label class="cfg-label-v7 mb-4">ESTADÍSTICAS ESTIMADAS</label>

                    <div class="stat-grid-v10 mb-6">
                        <div class="stat-item-v10">
                            <span class="stat-label">Winners</span>
                            <div class="flex-row gap-2 items-center">
                                <button class="btn-icon-xs" onclick="stepCount('winners', -1)"><i
                                        class="fas fa-minus"></i></button>
                                <span class="text-xl font-black text-sport-green" id="val-winners">0</span>
                                <button class="btn-icon-xs" onclick="stepCount('winners', 1)"><i
                                        class="fas fa-plus"></i></button>
                            </div>
                        </div>
                        <div class="stat-item-v10">
                            <span class="stat-label">Errores No Forzados</span>
                            <div class="flex-row gap-2 items-center">
                                <button class="btn-icon-xs" onclick="stepCount('ue', -1)"><i
                                        class="fas fa-minus"></i></button>
                                <span class="text-xl font-black text-sport-red" id="val-ue">0</span>
                                <button class="btn-icon-xs" onclick="stepCount('ue', 1)"><i
                                        class="fas fa-plus"></i></button>
                            </div>
                        </div>
                    </div>

                    <div class="cfg-group-v9 mb-6">
                        <label class="cfg-label-v7">% PUNTOS GANADOS (ESTIMADO)</label>
                        <div class="stat-item-v10 w-full mb-2">
                            <span class="stat-label">EN LA RED (VOLEA/REMATE)</span>
                            <input type="range" id="rng-net" class="w-full form-range" min="0" max="100" value="50"
                                oninput="document.getElementById('lbl-net').innerText=this.value+'%'">
                            <span class="text-xs font-bold text-right block" id="lbl-net">50%</span>
                        </div>
                        <div class="stat-item-v10 w-full">
                            <span class="stat-label">DESDE EL FONDO</span>
                            <input type="range" id="rng-back" class="w-full form-range" min="0" max="100" value="50"
                                oninput="document.getElementById('lbl-back').innerText=this.value+'%'">
                            <span class="text-xs font-bold text-right block" id="lbl-back">50%</span>
                        </div>
                    </div>
                </div>

                <!-- STEP 4: BIOMETRÍA -->
                <div id="step-4" class="wizard-step">
                    <label class="cfg-label-v7 mb-4">ESTADO DEL JUGADOR</label>

                    <div class="sliders-v9 mb-6">
                        <div class="sl-item">
                            <div class="flex-between mb-2">
                                <span class="sl-label">ENERGÍA FÍSICA</span>
                                <span class="sl-val" id="val-fisico">5</span>
                            </div>
                            <input type="range" id="inp-fisico" min="1" max="10" value="5" class="sl-range fisico">
                        </div>
                        <div class="sl-item">
                            <div class="flex-between mb-2">
                                <span class="sl-label">CONCENTRACIÓN</span>
                                <span class="sl-val" id="val-mental">5</span>
                            </div>
                            <input type="range" id="inp-mental" min="1" max="10" value="5" class="sl-range mental">
                        </div>
                        <div class="sl-item">
                            <div class="flex-between mb-2">
                                <span class="sl-label">CONFIANZA</span>
                                <span class="sl-val" id="val-confianza">5</span>
                            </div>
                            <input type="range" id="inp-confianza" min="1" max="10" value="5" class="sl-range tactica">
                        </div>
                    </div>

                    <div class="cfg-group-v9">
                        <label class="cfg-label-v7">BIOMETRÍA EMOCIONAL</label>
                        <div class="mood-matrix-v9" id="mood-box">
                            <button class="mood-face" data-mood="Frustrado"><i
                                    class="fas fa-face-angry"></i><span>Frustrado</span></button>
                            <button class="mood-face" data-mood="Cansado"><i
                                    class="fas fa-face-tired"></i><span>Cansado</span></button>
                            <button class="mood-face active" data-mood="Normal"><i
                                    class="fas fa-face-meh"></i><span>Normal</span></button>
                            <button class="mood-face" data-mood="Motivado"><i
                                    class="fas fa-fire"></i><span>Motivado</span></button>
                            <button class="mood-face" data-mood="Fluido"><i
                                    class="fas fa-bolt"></i><span>Fluido</span></button>
                        </div>
                    </div>
                </div>

                <!-- STEP 5: ANALISIS -->
                <div id="step-5" class="wizard-step">
                    <div class="cfg-group-v9 mb-6">
                        <label class="cfg-label-v7">CLAVES TÁCTICAS</label>
                        <input type="text" id="inp-key-moment" class="input-v9 mb-3"
                            placeholder="Momento clave del partido...">
                        <input type="text" id="inp-damage-received" class="input-v9 mb-3"
                            placeholder="¿Qué te hizo más daño?">
                        <input type="text" id="inp-damage-inflicted" class="input-v9"
                            placeholder="¿Qué les hizo daño a ellos?">
                    </div>

                    <div class="cfg-group-v9 mb-4">
                        <label class="cfg-label-v7">NOTAS LIBRES</label>
                        <textarea id="entry-notes" class="area-v9" rows="4"
                            placeholder="Análisis profundo..."></textarea>
                    </div>
                </div>

            </div>

            <!-- Wizard Footer Action -->
            <div class="sheet-footer-v7 absolute bottom-0 w-full left-0 p-6 bg-cosmic border-t border-white/5 z-10">
                <div class="flex-row gap-4 w-full">
                    <button class="btn-cancel-v9 flex-1" id="btn-prev" onclick="window.wizardPrev()"
                        style="display:none">ATRÁS</button>
                    <button class="btn-save-v9 flex-[2]" id="btn-next" onclick="window.wizardNext()">
                        <span id="btn-next-text">SIGUIENTE</span>
                        <i class="fas fa-chevron-right" id="btn-next-icon"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="./js/diario-logic.js?v=6.5"></script>
    <script type="module">
        import { initGalaxyBackground } from './js/modules/galaxy-bg.js?v=6.5';
        import { initThemeSystem } from './js/modules/theme-manager.js?v=6.5';
        initThemeSystem();
        initGalaxyBackground();
    </script>
    <script>
        // quick helper for counters
        window.stepCount = (id, delta) => {
            const el = document.getElementById('val-' + id);
            if (el) {
                let v = parseInt(el.innerText) + delta;
                if (v < 0) v = 0;
                el.innerText = v;
            }
        }
    </script>
</body>

</html>