<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#020617">
    <title>Perfil | Padeluminatis Pro</title>
    <meta name="description" content="Tu perfil de jugador en Padeluminatis">
    <link rel="icon" type="image/x-icon" href="./imagenes/Logojafs.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Core Bundle: design-system + layout + components-premium + themes + dynamic-elements -->
    <link rel="stylesheet" href="./css/core-bundle.css">
    <link rel="stylesheet" href="./css/themes.css">
    <link rel="stylesheet" href="./css/perfil.css">
    <!-- Premium V7 Styles (New Design - High Priority) -->
    <link rel="stylesheet" href="./css/premium-v7.css">
</head>

<body>
    <!-- Galactic Background -->
    <div class="sport-bg"></div>

    <!-- Header & Nav injected by JS -->

    <main class="page-content profile-page">

        <!-- Profile Hero Card -->
        <section class="profile-hero animate-fade-in">
            <div class="profile-hero-bg"></div>
            <div class="profile-hero-content">
                <!-- Avatar -->
                <div class="profile-avatar-wrapper" onclick="document.getElementById('upload-photo').click()">
                    <div class="profile-avatar">
                        <img id="p-avatar" src="./imagenes/default-avatar.png" alt="Avatar">
                        <div class="avatar-initial" id="avatar-fallback" style="display:none;">?</div>
                    </div>
                    <div class="avatar-edit-btn">
                        <i class="fas fa-camera"></i>
                    </div>
                    <div class="avatar-ring"></div>
                </div>
                <input type="file" id="upload-photo" hidden accept="image/*">

                <!-- Name & Badge -->
                <h1 class="profile-name" id="p-name">Cargando...</h1>
                <div class="profile-badge">
                    <i class="fas fa-crown"></i>
                    <span id="p-role">Atleta Pro</span>
                </div>

                <!-- Quick Stats Horizontal (Premium V7) -->
                <div class="grid grid-cols-3 gap-3 w-full max-w-[340px] mt-6">
                    <div class="stat-card-v7 cyan clickable" id="profile-stat-level">
                        <span class="text-[9px] font-black uppercase text-muted tracking-widest">Nivel</span>
                        <span id="p-nivel" class="text-lg font-black italic">2.5</span>
                    </div>
                    <div class="stat-card-v7 gold clickable" id="profile-stat-points">
                        <span class="text-[9px] font-black uppercase text-muted tracking-widest">Puntos</span>
                        <span id="p-puntos" class="text-lg font-black italic">0</span>
                    </div>
                    <div class="stat-card-v7 lime clickable" id="profile-stat-streak">
                        <span class="text-[9px] font-black uppercase text-muted tracking-widest">Racha</span>
                        <span id="p-streak" class="text-lg font-black italic">0</span>
                    </div>
                </div>
            </div>
        </section>

        <section class="profile-section animate-fade-in" style="animation-delay: 0.08s;">
            <div id="fut-card-container" class="fut-card-wrap">
                <div class="text-center py-6 opacity-40 text-[10px] font-black uppercase">Cargando carta de jugador...</div>
            </div>
        </section>

        <!-- Level Progress Breakdown -->
        <section class="profile-section animate-fade-in" style="animation-delay: 0.1s;">
            <div class="card card-premium-v7 shadow-cyan/10">
                <div class="flex-row between items-center mb-4">
                    <div class="flex-col">
                        <span class="text-[10px] font-black text-muted uppercase tracking-widest">Progreso de
                            Nivel</span>
                        <span id="p-level-current"
                            class="text-xs font-black text-white italic mt-1">Sincronizando...</span>
                    </div>
                    <div class="flex-col items-end">
                        <span class="text-[10px] font-black text-muted uppercase tracking-widest">Próximo Nivel</span>
                        <span id="level-upper" class="text-xs font-black text-primary italic mt-1">3.0</span>
                    </div>
                </div>

                <div class="progress-bar-v7 large mb-2">
                    <div id="level-bar" class="fill-bar gradient-cyan" style="width: 50%;"></div>
                </div>

                <div class="flex-row between text-[9px] font-black text-muted uppercase">
                    <span id="level-lower">2.5</span>
                    <div id="level-progress-detail" class="flex-row gap-2"></div>
                    <span id="level-upper-bottom">3.0</span>
                </div>
            </div>
        </section>

        <!-- ENTIRE NEW COMPETITIVE SECTION -->
        <section class="profile-section animate-fade-in" style="animation-delay: 0.12s;">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-hand-fist text-accent mr-2"></i>GÉNESIS TÁCTICA</h2>
            </div>
            <div class="nexus-grid-v9">
                <div class="nexus-item-v9 gold">
                    <i class="fas fa-skull-crossbones n-icon"></i>
                    <div class="n-info">
                        <span class="n-lbl">NÉMESIS</span>
                        <span class="n-val" id="profile-nemesis">---</span>
                    </div>
                </div>
                <div class="nexus-item-v9 cyan">
                    <i class="fas fa-crown n-icon"></i>
                    <div class="n-info">
                        <span class="n-lbl">VÍCTIMA</span>
                        <span class="n-val" id="profile-victim">---</span>
                    </div>
                </div>
                <div class="nexus-item-v9 magenta">
                    <i class="fas fa-user-group n-icon"></i>
                    <div class="n-info">
                        <span class="n-lbl">SOCIO FIEL</span>
                        <span class="n-val" id="profile-partner">---</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- ELO Graph -->
        <section class="profile-section animate-fade-in" style="animation-delay: 0.15s;">
            <div class="section-header">
                <h2 class="section-title">Evolución ELO</h2>
                <span class="section-subtitle">Últimos 10 partidos</span>
            </div>
            <div class="elo-chart-card">
                <canvas id="elo-chart" height="100"></canvas>
            </div>
        </section>

        <!-- ELITE STATS (NEW) -->
        <section class="profile-section animate-fade-in" style="animation-delay: 0.18s;">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-atom text-cyan-400 mr-2"></i>ESTADÍSTICAS ELITE</h2>
            </div>

            <!-- Positional ELO -->
            <div class="stat-grid-v10 mb-4">
                <div class="stat-item-v10">
                    <span class="stat-label">ELO DRIVE</span>
                    <span class="text-xl font-black text-white" id="elo-drive">---</span>
                </div>
                <div class="stat-item-v10">
                    <span class="stat-label">ELO REVÉS</span>
                    <span class="text-xl font-black text-white" id="elo-reves">---</span>
                </div>
                <div class="stat-item-v10">
                    <span class="stat-label">INDOOR</span>
                    <span class="text-xl font-black text-white" id="elo-indoor">---</span>
                </div>
                <div class="stat-item-v10">
                    <span class="stat-label">OUTDOOR</span>
                    <span class="text-xl font-black text-white" id="elo-outdoor">---</span>
                </div>
            </div>

            <!-- Advanced Meters -->
            <div class="cfg-group-v9 mb-4">
                <div class="flex-between mb-1">
                    <span class="text-[9px] font-black tracking-widest text-primary">CONSISTENCIA</span>
                    <span class="text-[9px] font-black text-white" id="val-consistency">50/100</span>
                </div>
                <div class="w-full h-1 bg-white/10 rounded-full overflow-hidden">
                    <div class="h-full bg-primary" id="bar-consistency" style="width: 50%"></div>
                </div>
            </div>
            <div class="cfg-group-v9 mb-4">
                <div class="flex-between mb-1">
                    <span class="text-[9px] font-black tracking-widest text-sport-gold">BAJO PRESIÓN</span>
                    <span class="text-[9px] font-black text-white" id="val-pressure">50/100</span>
                </div>
                <div class="w-full h-1 bg-white/10 rounded-full overflow-hidden">
                    <div class="h-full bg-sport-gold" id="bar-pressure" style="width: 50%"></div>
                </div>
            </div>
        </section>

        <!-- RIVAL INTELLIGENCE DASHBOARD (PHASE 3) -->
        <section class="profile-section animate-fade-in" style="animation-delay: 0.20s;">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-crosshairs text-red-500 mr-2"></i>RIVAL INTELLIGENCE</h2>
            </div>
            <!-- Mock Content Container - Will be populated by JS -->
            <div id="rival-intel-dashboard" class="journal-card-v10">
                <div class="text-center opacity-50 text-[10px] font-black uppercase">
                    Selecciona un rival para ver análisis
                </div>
            </div>
        </section>
        </section>

        <!-- Tactical Balance Radar -->
        <section class="profile-section animate-fade-in" style="animation-delay: 0.1s;">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-microchip text-primary mr-2"></i>ADN TÁCTICO</h2>
                <span class="section-subtitle">Balance de habilidades</span>
            </div>
            <div class="radar-card-v9">
                <canvas id="tactical-radar-chart"></canvas>
            </div>
            <!-- Attribute Progress Bars (RPG Style) -->
            <div id="attribute-list" class="mt-4 px-2">
                <!-- Injected via JS -->
            </div>
        </section>

        <!-- Predictive Intelligence & Profile (NEW) -->
        <section class="profile-section animate-fade-in" style="animation-delay: 0.22s;">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-brain text-purple-400 mr-2"></i>INTELIGENCIA ADAPTATIVA</h2>
            </div>
            <div id="ai-profile-insights" class="grid grid-cols-2 gap-3 mb-4">
                <!-- Injected via JS -->
                <div class="loading-matrix text-center py-4 col-span-2">
                    <div class="spinner-neon mb-2"></div>
                </div>
            </div>

            <div class="section-header mt-4">
                <h2 class="section-title">AUTOMATIZACIONES</h2>
            </div>
            <div id="ai-automations" class="flex flex-col gap-2">
                <!-- Injected via JS -->
            </div>
        </section>

        <!-- Achievements / Hall of Fame -->
        <section class="profile-section animate-fade-in" style="animation-delay: 0.15s;">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-medal text-sport-gold mr-2"></i>SALA DE TROFEOS</h2>
                <span id="achv-count-label" class="text-[10px] font-black opacity-40 uppercase">0 DESBLOQUEADOS</span>
            </div>
            <div id="achievements-grid" class="achievements-grid-v9">
                <!-- Achievements injected by JS -->
                <div class="loading-ach text-center py-10 opacity-30">
                    <div class="spinner-neon mb-2"></div>
                    <span class="text-[9px] font-black tracking-widest">SINCRONIZANDO LOGROS...</span>
                </div>
            </div>
        </section>

        <!-- Stats Cards Grid -->
        <section class="profile-section animate-fade-in" style="animation-delay: 0.2s;">
            <div class="section-header">
                <h2 class="section-title">Métricas de Rendimiento</h2>
            </div>
            <div class="profile-stats-grid-v9">
                <div class="stat-card-v9 cyan">
                    <span class="s-lbl">PARTIDOS</span>
                    <span class="s-val" id="stat-total-matches">0</span>
                    <div class="s-icon"><i class="fas fa-gamepad"></i></div>
                </div>
                <div class="stat-card-v9 gold">
                    <span class="s-lbl">VICTORIAS</span>
                    <span class="s-val" id="stat-total-wins">0</span>
                    <div class="s-icon"><i class="fas fa-trophy"></i></div>
                </div>
                <div class="stat-card-v9 magenta">
                    <span class="s-lbl">RACHA</span>
                    <span class="s-val" id="stat-streak">0</span>
                    <div class="s-icon"><i class="fas fa-fire"></i></div>
                </div>
                <div class="stat-card-v9 lime">
                    <span class="s-lbl">EFICACIA</span>
                    <span class="s-val" id="stat-winrate">0%</span>
                    <div class="s-icon"><i class="fas fa-percent"></i></div>
                </div>
            </div>
        </section>

        <!-- Settings Section -->
        <section class="profile-section animate-fade-in" style="animation-delay: 0.25s;">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-cog text-white/30 mr-2"></i>Configuración</h2>
            </div>
            <div class="settings-card">
                <!-- Alias -->
                <div class="setting-item">
                    <div class="setting-left">
                        <i class="fas fa-id-badge"></i>
                        <span>Alias de Combate</span>
                    </div>
                    <div class="setting-right">
                        <input type="text" id="p-username-inp" class="setting-input" placeholder="Tu alias...">
                        <button class="setting-save-btn" id="p-save-name">
                            <i class="fas fa-check"></i>
                        </button>
                    </div>
                </div>
                <!-- Phone -->
                <div class="setting-item">
                    <div class="setting-left">
                        <i class="fas fa-mobile-screen"></i>
                        <span>Teléfono</span>
                    </div>
                    <div class="setting-right">
                        <input type="tel" id="p-phone-inp" class="setting-input" placeholder="600 000 000">
                        <button class="setting-save-btn success" id="p-save-phone">
                            <i class="fas fa-check"></i>
                        </button>
                    </div>
                </div>
                <!-- Change Password -->
                <div class="setting-item flex-col" style="align-items:stretch;">
                    <div class="flex-row items-center gap-3 mb-3">
                        <i class="fas fa-lock text-muted"></i>
                        <span class="text-xs font-bold text-white">Cambiar Contraseña</span>
                    </div>
                    <input type="password" id="p-new-password" class="setting-input mb-2 w-full"
                        placeholder="Nueva contraseña (mín. 6 caracteres)">
                    <input type="password" id="p-confirm-password" class="setting-input mb-3 w-full"
                        placeholder="Confirmar nueva contraseña">
                    <button class="btn btn-sm btn-secondary w-full" id="btn-change-password">
                        <i class="fas fa-shield-halved mr-1"></i> Actualizar Contraseña
                    </button>
                </div>
                <!-- Links -->
                <a href="diario.html" class="setting-item link">
                    <div class="setting-left">
                        <i class="fas fa-book-medical"></i>
                        <span>Diario Táctico</span>
                    </div>
                    <i class="fas fa-chevron-right setting-arrow"></i>
                </a>
                <a href="historial.html" class="setting-item link">
                    <div class="setting-left">
                        <i class="fas fa-history"></i>
                        <span>Historial Partidos</span>
                    </div>
                    <i class="fas fa-chevron-right setting-arrow"></i>
                </a>
            </div>
        </section>

        <!-- Address Section -->
        <section class="profile-section animate-fade-in" style="animation-delay: 0.3s;">
            <div class="section-header">
                <h2 class="section-title">Dirección</h2>
            </div>
            <div class="address-card">
                <div class="address-grid">
                    <div class="address-field">
                        <label>Bloque</label>
                        <input type="text" id="addr-bloque" placeholder="-">
                    </div>
                    <div class="address-field">
                        <label>Piso</label>
                        <input type="text" id="addr-piso" placeholder="-">
                    </div>
                    <div class="address-field">
                        <label>Puerta</label>
                        <input type="text" id="addr-puerta" placeholder="-">
                    </div>
                </div>
                <button class="btn btn-secondary w-full mt-4" id="save-address">
                    <i class="fas fa-save"></i>
                    Guardar Dirección
                </button>
            </div>
        </section>

        <!-- Gear Section -->
        <section class="profile-section animate-fade-in" style="animation-delay: 0.35s;">
            <div class="section-header">
                <h2 class="section-title">Inventario de Palas</h2>
                <div style="display:flex; gap:8px;">
                    <button class="btn btn-sm btn-secondary" onclick="window.location.href='palas.html'">
                        <i class="fas fa-microscope"></i> Lab
                    </button>
                    <button class="btn btn-sm btn-primary" onclick="openGearModal()">
                        <i class="fas fa-plus"></i> Añadir
                    </button>
                </div>
            </div>
            <div id="gear-container" class="gear-list">
                <!-- Gear cards injected by JS -->
            </div>
        </section>

        <!-- Theme Selector Section -->
        <section class="profile-section animate-fade-in" style="animation-delay: 0.35s;">
            <div class="section-header">
                <h2 class="section-title">Tema Visual</h2>
                <span class="section-subtitle">Personaliza tu experiencia</span>
            </div>
            <div id="theme-selector-container" class="settings-card" style="padding: 16px;">
                <!-- Theme options injected by JS -->
            </div>
        </section>

        <!-- Logout -->
        <section class="profile-section animate-fade-in" style="animation-delay: 0.45s;">
            <button class="btn btn-ghost btn-danger-text w-full" id="btn-logout">
                <i class="fas fa-sign-out-alt"></i>
                Cerrar Sesión
            </button>
        </section>

    </main>

    <!-- Gear Modal -->
    <div id="modal-gear" class="modal-overlay">
        <div class="modal-card">
            <div class="modal-header">
                <h3 class="modal-title">Nueva Pala</h3>
                <button class="modal-close" onclick="document.getElementById('modal-gear').classList.remove('active')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Marca</label>
                    <input type="text" id="gear-marca" class="input" placeholder="Ej: Nox, Bullpadel, Adidas...">
                </div>
                <div class="form-group">
                    <label class="form-label">Modelo</label>
                    <input type="text" id="gear-modelo" class="input" placeholder="Ej: AT10 Genius, Hack 03...">
                </div>

                <div class="divider"></div>

                <div class="form-group">
                    <label class="form-label">Características</label>

                    <div class="range-group">
                        <span class="range-label">Potencia</span>
                        <input type="range" id="gear-potencia" min="1" max="10" value="5" class="form-range">
                        <span class="range-value secondary" id="val-potencia">5</span>
                    </div>

                    <div class="range-group">
                        <span class="range-label">Control</span>
                        <input type="range" id="gear-control" min="1" max="10" value="5" class="form-range">
                        <span class="range-value primary" id="val-control">5</span>
                    </div>

                    <div class="range-group">
                        <span class="range-label">Manejabilidad</span>
                        <input type="range" id="gear-manejo" min="1" max="10" value="5" class="form-range">
                        <span class="range-value success" id="val-manejo">5</span>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Forma</label>
                    <select id="gear-forma" class="form-select">
                        <option value="">Selecciona Forma...</option>
                        <option value="redonda">Redonda (Control)</option>
                        <option value="lagrima">Lágrima (Equilibrada)</option>
                        <option value="diamante">Diamante (Potencia)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Peso</label>
                    <select id="gear-peso" class="form-select">
                        <option value="">Selecciona Peso...</option>
                        <option value="355-365">Ligera (355-365g)</option>
                        <option value="365-375">Media (365-375g)</option>
                        <option value="375-385">Pesada (375-385g)</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-ghost"
                    onclick="document.getElementById('modal-gear').classList.remove('active')">
                    Cancelar
                </button>
                <button class="btn btn-primary" onclick="savePala()">
                    <i class="fas fa-save"></i> Guardar
                </button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="module" src="./js/perfil.js?v=6.5"></script>


    <script type="module">
        import { initGalaxyBackground } from './js/modules/galaxy-bg.js?v=6.5';
        import { initThemeSystem, renderThemeSelector } from './js/modules/theme-manager.js?v=6.5';

        initThemeSystem();
        initGalaxyBackground();

        // Render theme selector once DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            renderThemeSelector('theme-selector-container');
        });
    </script>
</body>

</html>

